apiVersion: v1
kind: Secret
metadata:
  name: erp-api-env
  namespace: erp
type: Opaque
stringData:
  # ============================================
  # DATABASE CONFIGURATION (In-Cluster)
  # ============================================
  # NOTE: These will be dynamically updated during deployment
  # DATABASE_URL will be set by build.sh based on actual database setup
  DATABASE_URL: "postgresql://postgres:__DYNAMIC_PASSWORD__@postgresql.erp.svc.cluster.local:5432/bengo_erp"
  DB_HOST: "postgresql.erp.svc.cluster.local"
  DB_PORT: "5432"
  DB_NAME: "bengo_erp"
  DB_USER: "postgres"
  DB_PASSWORD: "__DYNAMIC_DB_PASSWORD__"

  # ============================================
  # REDIS CONFIGURATION (In-Cluster)
  # ============================================
  # NOTE: These will be dynamically updated during deployment
  REDIS_URL: "redis://:__DYNAMIC_REDIS_PASSWORD__@redis-master.erp.svc.cluster.local:6379/0"
  REDIS_HOST: "redis-master.erp.svc.cluster.local"
  REDIS_PORT: "6379"
  REDIS_PASSWORD: "__DYNAMIC_REDIS_PASSWORD__"
  CELERY_BROKER_URL: "redis://:__DYNAMIC_REDIS_PASSWORD__@redis-master.erp.svc.cluster.local:6379/0"
  CELERY_RESULT_BACKEND: "redis://:__DYNAMIC_REDIS_PASSWORD__@redis-master.erp.svc.cluster.local:6379/1"

  # ============================================
  # DJANGO CONFIGURATION
  # ============================================
  DJANGO_SECRET_KEY: "__DYNAMIC_DJANGO_SECRET__"
  DJANGO_SETTINGS_MODULE: "ProcureProKEAPI.settings"
  DEBUG: "False"
  DJANGO_ENV: "production"
  ALLOWED_HOSTS: "erpapi.masterspace.co.ke,localhost,127.0.0.1,*.masterspace.co.ke"

  # ============================================
  # SECURITY & JWT
  # ============================================
  # NOTE: JWT_SECRET will be dynamically generated during deployment
  JWT_SECRET: "__DYNAMIC_JWT_SECRET__"
  SECRET_KEY: "__DYNAMIC_SECRET_KEY__"

  # ============================================
  # CORS & FRONTEND
  # ============================================
  CORS_ALLOWED_ORIGINS: "https://erp.masterspace.co.ke,http://localhost:3000,*.masterspace.co.ke"
  FRONTEND_URL: "https://erp.masterspace.co.ke"

  # ============================================
  # MEDIA STORAGE CONFIGURATION (Optional)
  # ============================================
  # Option 1: Use S3 for media files (recommended for production multi-replica deployments)
  # USE_S3: "true"
  # AWS_ACCESS_KEY_ID: "AKIAIOSFODNN7EXAMPLE"
  # AWS_SECRET_ACCESS_KEY: "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"
  # AWS_STORAGE_BUCKET_NAME: "bengo-erp-media"
  # AWS_S3_REGION_NAME: "us-east-1"
  # AWS_S3_CUSTOM_DOMAIN: "media.bengoerp.com"
  
  # Option 2: Use PersistentVolume (default, configured in Helm chart)
  # Media files stored in /app/media mounted via PVC
  # Good for single-region deployments with ReadWriteMany support
  MEDIA_ROOT: "/app/media"
  MEDIA_URL: "/media/"

  # Static files (served by WhiteNoise in-memory, no volume needed)
  STATIC_ROOT: "/app/staticfiles"
  STATIC_URL: "/static/"

  # ============================================
  # EMAIL CONFIGURATION (Optional)
  # ============================================
  EMAIL_BACKEND: "django.core.mail.backends.smtp.EmailBackend"
  EMAIL_HOST: "smtp.gmail.com"
  EMAIL_PORT: "587"
  EMAIL_USE_TLS: "True"
  EMAIL_HOST_USER: "info@codevertexitsolutions.com"
  EMAIL_HOST_PASSWORD: "CHANGE_ME_GMAIL_APP_PASSWORD"
  DEFAULT_FROM_EMAIL: "info@codevertexitsolutions.com"
